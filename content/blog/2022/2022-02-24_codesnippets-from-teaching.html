---
title: Codesnippets from teaching
author: Catherine Blatter
date: '2022-02-24'
slug: codesnippets-teaching
categories: []
tags: []
Categories:
Description: ''
Tags:
    - teaching
menu: []
toc: true
output:
  blogdown::html_page:
    toc: true
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#renaming-columns---dplyr-and-base-example">Renaming columns - {dplyr} and {base} example</a>
<ul>
<li><a href="#tldr---code-please">TL;DR - code please</a></li>
</ul></li>
</ul>
</div>

<p><em>Every once in a while I create small code snippets demonstrating something in R.
Up to today, there was no place for this to live, so here it is…</em></p>
<div id="renaming-columns---dplyr-and-base-example" class="section level1">
<h1>Renaming columns - {dplyr} and {base} example</h1>
<p><strong>Loading the necessary library</strong></p>
<pre class="r"><code>library(dplyr, warn.conflicts = F) # A Grammar of Data Manipulation, CRAN v1.0.8 </code></pre>
<p><strong>Sample dataframe</strong></p>
<p>Creating a sample dataframe: the function <code>tribble()</code> lets you construct
rowwise-tibbles (thus the R in <code>tribble()</code>). This is closer to the idea of
data in a spreadsheet than the mirrored version with <code>tibble()</code> or <code>data.frame()</code>.</p>
<pre class="r"><code>df &lt;- tibble::tribble(
  ~id, ~pesnwi_leadership, ~pesnwi_sra, ~bernca_adl, ~bernca_docu,
  1, 2.3, 2.1, 1.8, 1.4,
  2, 2.0, 3, 2.1, 0.9,
  3, 3.1, 3.5, 3.9, 3
)</code></pre>
<p>This is the equivalent code for the ‘mirrored’ version:</p>
<pre class="r"><code>df &lt;- 
  data.frame(
                   id = c(1, 2, 3),
    pesnwi_leadership = c(2.3, 2, 3.1),
           pesnwi_sra = c(2.1, 3, 3.5),
           bernca_adl = c(1.8, 2.1, 3.9),
          bernca_docu = c(1.4, 0.9, 3)
  )</code></pre>
<p>Finally, this is how the dataframe looks like:</p>
<pre class="r"><code>df</code></pre>
<pre><code>## # A tibble: 3 × 5
##      id pesnwi_leadership pesnwi_sra bernca_adl bernca_docu
##   &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     1               2.3        2.1        1.8         1.4
## 2     2               2          3          2.1         0.9
## 3     3               3.1        3.5        3.9         3</code></pre>
<p><strong>Manual renaming with <code>dplyr::rename()</code></strong></p>
<p>Manual renaming following the idea of newname = oldname.
This is the approach you need to take for manual replacement of
column-names (see an equivalent base-R code below). You can rename more than
three variables like this, just add further combinations of newname = oldname…</p>
<pre class="r"><code>df %&gt;%
  rename(
    pesnwi_ls = pesnwi_leadership,
    ration_adl = bernca_adl,
    ration_docu = bernca_docu
  )</code></pre>
<pre><code>## # A tibble: 3 × 5
##      id pesnwi_ls pesnwi_sra ration_adl ration_docu
##   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     1       2.3        2.1        1.8         1.4
## 2     2       2          3          2.1         0.9
## 3     3       3.1        3.5        3.9         3</code></pre>
<p><strong>Manual renaming with <code>base-R</code></strong></p>
<p>Of course its also possible to rename the columns with other approaches, e.g. :</p>
<pre class="r"><code>names(df)[names(df)==&quot;pesnwi_leadership&quot;] &lt;- &quot;pesnwi_ls&quot;</code></pre>
<p><strong>Automatic renaming with <code>dplyr::rename_with()</code></strong></p>
<p>It’s possible to rename multiple column-names based on matching text-patterns
(regular expression). This is great if you need to rename multiple variables with
the same pattern, but it only works if you can find such a pattern. If you’re in
doubt which option to choose its probably safer to do the manual method above…</p>
<p>For the example dataframe, say we want to replace the prefix “bernca” (the name of
an instrument to measure rationed nursing care<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>)
by the more general term “ration”. This is possible with the following code:</p>
<pre class="r"><code>df %&gt;%
  rename_with(
    .fn = ~ stringr::str_replace(., pattern = &quot;bernca&quot;, replacement = &quot;ration&quot;),
    .cols = everything()
  )</code></pre>
<pre><code>## # A tibble: 3 × 5
##      id pesnwi_leadership pesnwi_sra ration_adl ration_docu
##   &lt;dbl&gt;             &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
## 1     1               2.3        2.1        1.8         1.4
## 2     2               2          3          2.1         0.9
## 3     3               3.1        3.5        3.9         3</code></pre>
<p>By default, all columns get considered, but we could limit this or manually
define the columns with <code>c(bernca_adl, bernca_docu)</code>.</p>
<div id="tldr---code-please" class="section level3">
<h3>TL;DR - code please</h3>
<pre class="r"><code># 1. Packages ---------------------------------------------------------------

library(dplyr) # A Grammar of Data Manipulation, CRAN v1.0.8 


# 2. Creating a sample-df -------------------------------------------------

# &#39;tribble()&#39; lets you construct rowwise-tibbles (thus the R in tribble())
# (resembles more the idea of data when you need to make an example dataframe)
(df &lt;- tibble::tribble(
  ~id, ~pesnwi_leadership, ~pesnwi_sra, ~bernca_adl, ~bernca_docu,
  1, 2.3, 2.1, 1.8, 1.4,
  2, 2.0, 3, 2.1, 0.9,
  3, 3.1, 3.5, 3.9, 3
))


# 3. Rename colnames -------------------------------------------

# a) using {dplyr} dplyr::rename()

# manual renaming following the idea of newname = oldname
# this is the approach you need to take for manual replacement of 
# column-names (see an equivalent base-R code below)
df %&gt;%
  rename(
    pesnwi_ls = pesnwi_leadership,
    ration_adl = bernca_adl,
    ration_docu = bernca_docu
  )


# b) using {base}-R syntax
names(df)[names(df)==&quot;pesnwi_leadership&quot;] &lt;- &quot;pesnwi_ls&quot;


# c) - automatic renaming based on text-pattern-matching (regular expression)
# ONLY WORKS IN SPECIFIC SITUATIONS - should always be checked manually

# for both &#39;bernca_&#39; variables you could use a function to replace &#39;bernca&#39; by &#39;ration&#39;
# but obviously this does not rename the &#39;pesnwi_ls&#39;
df %&gt;%
  rename_with(
    .fn = ~ stringr::str_replace(., pattern = &quot;bernca&quot;, replacement = &quot;ration&quot;),
    .cols = everything()
  )
</code></pre>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Schubert et al., 2007, <a href="https://doi.org/10.1097/01.nnr.0000299853.52429.62" class="uri">https://doi.org/10.1097/01.nnr.0000299853.52429.62</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
